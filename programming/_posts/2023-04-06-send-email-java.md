---
layout: post
title: Spring(Java) ì´ë©”ì¼ ì¸ì¦ êµ¬í˜„(with Google)
description: >
  êµ¬ê¸€ ì„¤ì • ë° Spring ì´ë©”ì¼ ì¸ì¦ êµ¬í˜„
sitemap: false
---

`Nodemailer`ë¥¼ ì‚¬ìš©í•´ì„œ ì´ë©”ì¼ ë³´ë‚´ê¸°ë¥¼ êµ¬í˜„í•˜ë ¤ê³  í•˜ë‹¤ê°€... ğŸ¤”
<br>
ì‘ë…„ì— `Notion`ì— ì‘ì„±í•´ ë†“ì€ ê¸€ê³¼ ì •ë³´ê°€ ê²¹ì³ì„œ ë¨¼ì € ì˜¬ë ¤ë³´ì•˜ìŠµë‹ˆë‹¤. 

# ğŸ“¥ ê°„ë‹¨ ì´ë©”ì¼ ì¸ì¦

## 1. ì¸ì¦ ì •ë³´ ì„¸íŒ…

### ğŸ™…â€â™‚ï¸ a. (ë¹„ì¶”ì²œ) ë³´ì•ˆ ìˆ˜ì¤€ì´ ë‚®ì€ ì•±ì˜ ì—‘ì„¸ìŠ¤ í—ˆìš©í•˜ê¸°
[ë³´ì•ˆ ìˆ˜ì¤€ì´ ë‚®ì€ ì•±ì˜ ì—‘ì„¸ìŠ¤](https://myaccount.google.com/lesssecureapps?pli=1&rapt=AEjHL4OTsfFueMecNzy1xPMqrw0Abe2okvsvyYh5mjoe9tA-Lant3IYRwVnuYglPe24k7TGiwugxh_WYmJRCkaOsPDvG3fSxyw) í•´ë‹¹ ë§í¬ë¥¼ í†µí•´ì„œ ì•± í—ˆìš©ì„ í•´ì£¼ì…”ì•¼ í•©ë‹ˆë‹¤.
<br>
<img width=500 src="https://user-images.githubusercontent.com/93169519/230929394-6f81d6af-0e14-47c9-ba9e-767bc0d934ba.png" />

í•´ë‹¹ ì„¤ì •ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ì•„ë˜ì™€ ê°™ì´ ì˜¤ë¥˜ê°€ ë°œìƒ ë©ë‹ˆë‹¤. ğŸ˜“
> Authentication failed; â€¦ Username and Password not accepted.

---
>ğŸ¤” ì˜ë¬¸ì´ ìƒˆë¡­ê²Œ ê³„ì •ì„ ìƒì„±í•´ì„œ ê°™ì€ ê³³ìœ¼ë¡œ ë“¤ì–´ê°€ë©´â€¦

<img width=500 src="https://user-images.githubusercontent.com/93169519/230929420-8e80c839-5fa5-4b43-a79a-e8b37aef6f0c.png" />

ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤ê³  ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤. ğŸ˜“ ~~ì¸ì¦ì„ í•´ì•¼ ë˜ëŠ”ê±´ê°€? ì‹¶ë„¤ìš”.~~ â†’ 2ì°¨ ì¸ì¦ì„ í•´ë„ ì•ˆë¨

<img width=500 src="https://user-images.githubusercontent.com/93169519/230931291-086e7dba-e9e7-458a-adce-def1c42003ae.png" />

[ë³´ì•ˆ ìˆ˜ì¤€ì´ ë‚®ì€ ì•± ë° Google ê³„ì • ë§í¬](https://support.google.com/accounts/answer/6010255?hl=ko&visit_id=637950495068647686-2065665416&p=less-secure-apps&rd=1)
<br>
ê²°êµ­ ë¡œê·¸ì¸ì„ í•´ì„œ ë©”ì¼ì„ ë³´ë‚´ëŠ” êµ¬ì¡°ë‹¤ ë³´ë‹ˆ.. ë³´ì•ˆì„ ìœ„í•´ì„œ ì§€ì›ì„ í•˜ì§€ ì•ŠëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ğŸ˜±


### ğŸ‘ b. (ì¶”ì²œ) 2ì°¨ ì¸ì¦ ì„¤ì •
ê³„ì • ê´€ë¦¬ â†’ ë³´ì•ˆ â†’ 2ë‹¨ê³„ ì¸ì¦ì„ í•´ì¤ë‹ˆë‹¤.
<br>
<img width=500 src="https://user-images.githubusercontent.com/93169519/230929443-6a6154c5-44bd-4f71-80d1-e3a85e92bea0.png" />

ì¸ì¦ì´ ì™„ë£Œ ë˜ì—ˆë‹¤ë©´, ê°™ì€ ê³³ì˜ ì•± ë¹„ë°€ë²ˆí˜¸ë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤.
<br>
<img width=500 src="https://user-images.githubusercontent.com/93169519/230929461-2a6ba35c-81fd-4959-83fb-2fa1d687c482.png" />

> ì´ì œ ì•± ë¹„ë°€ë²ˆí˜¸ë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.
- ì•± ì„ íƒ â†’ ê¸°íƒ€
- **ê¸°ê¸° ì„ íƒ** â†’ ê¸°íƒ€(ë§ì¶¤ ì´ë¦„)
- **ì•± ì´ë¦„ ì„¤ì •** í›„ **ìƒì„± ë²„íŠ¼ì„ í´ë¦­**í•©ë‹ˆë‹¤.
<br>
<img width=500 src="https://user-images.githubusercontent.com/93169519/230929472-f658a034-19ae-491c-a660-d07b89feeabc.png" />

ğŸ¶ ì´ì œ ìƒì„±ëœ ê¸°ê¸°ìš© ì•± ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.

## 2. Spring(Java) ì½”ë“œ ì‘ì„±
### ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
```xml
implementation 'org.springframework.boot:spring-boot-starter-mail'
```
- **MailSender ì¸í„°í˜ì´ìŠ¤**
  - ê°„ë‹¨í•œ ì´ë©”ì¼ì„ ë³´ë‚´ê¸° ìœ„í•œ ê¸°ë³¸ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ìµœìƒìœ„ í´ë˜ìŠ¤

- **JavaMailSender ì¸í„°í˜ì´ìŠ¤**
  - MailSenderì˜ í•˜ìœ„ ì¸í„°í˜ì´ìŠ¤
  - MIME ë©”ì‹œì§€ë¥¼ ì§€ì›í•˜ë©° ëŒ€ë¶€ë¶„ì˜ MimeMessgeë¥¼ ìƒì„±ì„ ìœ„í•´ MimeMessageHelper í´ë˜ìŠ¤ì™€ í•¨ê»˜ ì‚¬ìš©
  - ì´ ì¸í„°í˜ì´ìŠ¤ì™€ í•¨ê»˜ MimeMessagePreparator ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
- **JavaMailSenderImplÂ í´ë˜ìŠ¤**
  - JavaMailSenderMimeMessageÂ ë° SimpleMailMessage ì¸í„°í˜ì´ìŠ¤Â ì˜ êµ¬í˜„ì„ ì œê³µí•©ë‹ˆë‹¤.

- **SimpleMailMessageÂ í´ë˜ìŠ¤**
  - ë³´ë‚¸ ì‚¬ëŒ, ë°›ëŠ” ì‚¬ëŒ, ì°¸ì¡°, ì œëª© ë° í…ìŠ¤íŠ¸ í•„ë“œë¥¼ í¬í•¨í•˜ëŠ” ê°„ë‹¨í•œ ë©”ì¼ ë©”ì‹œì§€ë¥¼ ë§Œë“œëŠ” ë° ì‚¬ìš©

- **MimeMessagePreparatorÂ ì¸í„°í˜ì´ìŠ¤**
  - MIME ë©”ì‹œì§€ ì¤€ë¹„ë¥¼ ìœ„í•œ ì½œë°± ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

- **MimeMessageHelperÂ í´ë˜ìŠ¤**
  - MIME ë©”ì‹œì§€ ìƒì„±ì„ ìœ„í•œ ë„ìš°ë¯¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
  - HTML ë ˆì´ì•„ì›ƒì˜ ì´ë¯¸ì§€, ì¼ë°˜ì ì¸ ë©”ì¼ ì²¨ë¶€ íŒŒì¼ ë° í…ìŠ¤íŠ¸ ì½˜í…ì¸ ì— ëŒ€í•œ
    ì§€ì›ì„ ì œê³µí•©ë‹ˆë‹¤.

### ì„¤ì • íŒŒì¼ ì‘ì„±
```yaml
spring:
  application:
    name: spring-email
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${SMTP_EMAIL}    
    password: ${SMTP_PASSWORD} # 2ì°¨ ì¸ì¦ ë°©ë²•ì´ë©´ ì•± ë¹„ë°€ë²ˆí˜¸!
    properties:
      mail:
        smtp:
          starttls:
            enable: true
            required: true
          auth: true
          connectiontimeout: 5000
          timout: 5000
          writetimeout: 5000
```
- connectiontimeout, timout, writetimeout : ë¬´í•œ ëŒ€ê¸° ìƒíƒœë¥¼ í”¼í•˜ê¸° ìœ„í•œ ì‹œê°„ ì„¤ì •

### ì´ë©”ì¼ ì„œë¹„ìŠ¤ ìƒì„± ë° ì‚¬ìš©
1. ì´ë©”ì¼ ì„œë¹„ìŠ¤ ìƒì„±
  <br>
    ```java
    @EnableAsync
    @RequiredArgsConstructor
    @Service
    public class EmailService {
      private final JavaMailSender javaMailSender;
    
      @Async
      public void send(String email, String authToken) {
        SimpleMailMessage smm = new SimpleMailMessage();
        smm.setTo(email);
        smm.setSubject("íšŒì›ê°€ì… ì´ë©”ì¼ ì¸ì¦");
        smm.setText("http://localhost:8080/api/users/confirm-email?email=" + email + "&authToken=" + authToken);
    
        javaMailSender.send(smm);
      }
    }
    ```
   - email : ì‚¬ìš©ë˜ëŠ” ì´ë©”ì¼ì„ ë“±ë¡
   - authToken : UUIDë¥¼ ì‚¬ìš©
2. ì´ì œ ë©”ì¼ì„ ë³´ë‚´ê²Œ ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì´ë©”ì¼ì´ ë°œì†¡ ë©ë‹ˆë‹¤.
  <br>
  <img width=500 src="https://user-images.githubusercontent.com/93169519/230929494-c88a8738-ddd2-454f-8063-876b4df25b1f.png" />
  <br>
   í•´ë‹¹ ë§í¬ë¡œ ìš”ì²­ì„ í†µí•´ì„œ ì¸ì¦ ì²˜ë¦¬ë¥¼ í•˜ê²Œ ë˜ëŠ” ê²ƒì´ì£ .

## ğŸ¤” ì¶”í›„ ê³ ë ¤í•´ë³¼ë§Œí•œ ëŒ€ì•ˆ
ë‘ ë²ˆì§¸ ë°©ë²• - AWS SES(Simple Email Service) ì‚¬ìš©
<br>
â†’ ë‹¨ì ìœ¼ë¡œëŠ” í•˜ë‚˜ì˜ ê´€ë¦¬ ëŒ€ìƒì¸ ë¦¬ì†ŒìŠ¤ê°€ ë” ìƒê¸´ë‹¤ëŠ” ì ì´ ìˆìŠµë‹ˆë‹¤.

## ğŸ”– ì°¸ê³  ì‚¬ì´íŠ¸
- [[Baeldung] Guide to Spring Email](https://www.baeldung.com/spring-email)
- [[SpringBoot] ì´ë©”ì¼ ì „ì†¡ ( JavaMailSender, MimeMessageHelper )](https://victorydntmd.tistory.com/342)
- [[ê´´ë°œê°œë°œ] REST API - ì´ë©”ì¼ ì¸ì¦](https://workshop-6349.tistory.com/entry/%EA%B4%B4%EB%B0%9C%EA%B0%9C%EB%B0%9C-REST-API-%EC%9D%B4%EB%A9%94%EC%9D%BC-%EC%9D%B8%EC%A6%9D?category=1007169)
- [[ì„œë²„ê°œë°œìº í”„] ì¸ì¦ ì„œë²„ - ì´ë©”ì¼ ì¸ì¦ íšŒì›ê°€ì…](https://yunb2.tistory.com/4)